import{g as p,b as o,l as h,c as f,o as m,r as d,s as u}from"./session-UX4NEy02.js";const n=p(),y=o("session-id"),l=o("session-phase"),C=o("mobile-url"),c=o("new-session"),a=o("copy-mobile"),w=Array.from(document.querySelectorAll("[data-phase]")),x="https://pilgrimbeart.github.io/custopolis/",E=e=>e.endsWith("/")?e:`${e}/`,g=E(x),b=new URL("mobile/",g).toString();C.textContent=b;let r=null,i=null;const U=async e=>{if(!i)return;const t=[];t.push(u(d(n,`sessions/${i}/phase`),e));const s=e.match(/^round-(\d+)$/);s&&t.push(u(d(n,`sessions/${i}/roundNumber`),Number(s[1]))),await Promise.all(t)},S=e=>{i=e,y.textContent=e??"Not set",l.textContent="-",r&&(r(),r=null),e&&(r=m(d(n,`sessions/${e}`),t=>{const s=t.val();l.textContent=s?.phase??"-"}))};h(n,S);c.addEventListener("click",async()=>{c.disabled=!0;try{await f(n)}catch(e){console.error(e),l.textContent="Error creating session"}finally{c.disabled=!1}});a.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(b),a.textContent="Copied!",window.setTimeout(()=>{a.textContent="Copy mobile URL"},1500)}catch(e){console.error(e),a.textContent="Copy failed"}});w.forEach(e=>{e.addEventListener("click",async()=>{const t=e.dataset.phase;if(t){e.disabled=!0;try{await U(t)}catch(s){console.error(s),l.textContent="Error setting phase"}finally{e.disabled=!1}}})});
